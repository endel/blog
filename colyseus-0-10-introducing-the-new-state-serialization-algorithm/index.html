<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Colyseus 0.10: Introducing the New State Serialization Algorithm</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css?v=0c1487f8cb" />

    <link rel="canonical" href="https://blog.endel.me/colyseus-0-10-introducing-the-new-state-serialization-algorithm/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="https://blog.endel.me/colyseus-0-10-introducing-the-new-state-serialization-algorithm/amp/" />
    
    <meta property="og:site_name" content="Endel → Brain#dump()" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Colyseus 0.10: Introducing the New State Serialization Algorithm" />
    <meta property="og:description" content="I’m really excited to announce the release 0.10 of Colyseus. This version basically introduces a more performant state serialization algorithm and a different way of decoding the state in the client-side. It’s currently available for JavaScript, Defold Engine and Unity3D. The new serializer (@colyseus/schema) optimizes not" />
    <meta property="og:url" content="https://blog.endel.me/colyseus-0-10-introducing-the-new-state-serialization-algorithm/" />
    <meta property="og:image" content="https://blog.endel.me/content/images/2020/07/colyseus-0.10.x.png" />
    <meta property="article:published_time" content="2019-03-28T18:39:00.000Z" />
    <meta property="article:modified_time" content="2020-07-18T18:40:29.000Z" />
    <meta property="article:tag" content="Colyseus" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Colyseus 0.10: Introducing the New State Serialization Algorithm" />
    <meta name="twitter:description" content="I’m really excited to announce the release 0.10 of Colyseus. This version basically introduces a more performant state serialization algorithm and a different way of decoding the state in the client-side. It’s currently available for JavaScript, Defold Engine and Unity3D. The new serializer (@colyseus/schema) optimizes not" />
    <meta name="twitter:url" content="https://blog.endel.me/colyseus-0-10-introducing-the-new-state-serialization-algorithm/" />
    <meta name="twitter:image" content="https://blog.endel.me/content/images/2020/07/colyseus-0.10.x.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Endel Dreyer" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Colyseus" />
    <meta name="twitter:site" content="@endel" />
    <meta name="twitter:creator" content="@endel" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Endel → Brain#dump()",
        "url": "https://blog.endel.me/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.endel.me/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "Endel Dreyer",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/c35f590e9178794d7f4c4f07192d3772?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "https://blog.endel.me/author/endel/",
        "sameAs": [
            "https://github.com/endel",
            "https://twitter.com/endel"
        ]
    },
    "headline": "Colyseus 0.10: Introducing the New State Serialization Algorithm",
    "url": "https://blog.endel.me/colyseus-0-10-introducing-the-new-state-serialization-algorithm/",
    "datePublished": "2019-03-28T18:39:00.000Z",
    "dateModified": "2020-07-18T18:40:29.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://blog.endel.me/content/images/2020/07/colyseus-0.10.x.png",
        "width": 1200,
        "height": 630
    },
    "keywords": "Colyseus",
    "description": "I’m really excited to announce the release 0.10 of Colyseus\n[https://github.com/colyseus/colyseus]. This version basically introduces a more\nperformant state serialization algorithm and a different way of decoding the\nstate in the client-side. It’s currently available for JavaScript\n[https://github.com/colyseus/colyseus.js], Defold Engine\n[https://github.com/colyseus/colyseus-defold] and Unity3D\n[https://github.com/colyseus/colyseus-unity3d].\n\nThe new serializer (@colyseus/schema [https://github",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://blog.endel.me/"
    }
}
    </script>

    <meta name="generator" content="Ghost 3.25" />
    <link rel="alternate" type="application/rss+xml" title="Endel → Brain#dump()" href="https://blog.endel.me/rss/" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/themes/prism-tomorrow.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/plugins/toolbar/prism-toolbar.min.css" />

<style>
    pre[class*=language-] {
        margin: 0 0 1.75em 0;
        font-size: 1.5rem;
    }
    div.code-toolbar {
        width: 100%;
    }
</style>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-173006829-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-173006829-1');
</script>

</head>
<body class="post-template tag-colyseus">

    <div class="site-wrapper">

        

<header class="site-header">
    <div class="outer site-nav-main">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left-wrapper">
        <div class="site-nav-left">
                <a class="site-nav-logo" href="https://blog.endel.me">Endel → Brain#dump()</a>
            <div class="site-nav-content">
                    <ul class="nav">
    <li class="nav-home"><a href="https://blog.endel.me/">Home</a></li>
    <li class="nav-projects"><a href="https://blog.endel.me/projects/">Projects</a></li>
    <li class="nav-patreon"><a href="http://patreon.com/endel">Patreon</a></li>
</ul>

                    <span class="nav-post-title dash">Colyseus 0.10: Introducing the New State Serialization Algorithm</span>
            </div>
        </div>
    </div>
    <div class="site-nav-right">
            <div class="social-links">
                    <a class="social-link social-link-tw" href="https://twitter.com/endel" title="Twitter" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
</a>
	        <a class="social-link social-link-tw" href="https://github.com/endel" title="GitHub" target="_blank" rel="noopener"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32">
<path d="M16 0.395c-8.836 0-16 7.163-16 16 0 7.069 4.585 13.067 10.942 15.182 0.8 0.148 1.094-0.347 1.094-0.77 0-0.381-0.015-1.642-0.022-2.979-4.452 0.968-5.391-1.888-5.391-1.888-0.728-1.849-1.776-2.341-1.776-2.341-1.452-0.993 0.11-0.973 0.11-0.973 1.606 0.113 2.452 1.649 2.452 1.649 1.427 2.446 3.743 1.739 4.656 1.33 0.143-1.034 0.558-1.74 1.016-2.14-3.554-0.404-7.29-1.777-7.29-7.907 0-1.747 0.625-3.174 1.649-4.295-0.166-0.403-0.714-2.030 0.155-4.234 0 0 1.344-0.43 4.401 1.64 1.276-0.355 2.645-0.532 4.005-0.539 1.359 0.006 2.729 0.184 4.008 0.539 3.054-2.070 4.395-1.64 4.395-1.64 0.871 2.204 0.323 3.831 0.157 4.234 1.026 1.12 1.647 2.548 1.647 4.295 0 6.145-3.743 7.498-7.306 7.895 0.574 0.497 1.085 1.47 1.085 2.963 0 2.141-0.019 3.864-0.019 4.391 0 0.426 0.288 0.925 1.099 0.768 6.354-2.118 10.933-8.113 10.933-15.18 0-8.837-7.164-16-16-16z"></path></svg>
</a>
            </div>
                <a class="rss-button" href="https://feedly.com/i/subscription/feed/https://blog.endel.me/rss/" title="RSS" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"/><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg>
</a>

    </div>
</nav>
    </div>
</div></header>


<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post tag-colyseus ">

            <header class="post-full-header">

                <section class="post-full-tags">
                    <a href="/tag/colyseus/">Colyseus</a>
                </section>

                <h1 class="post-full-title">Colyseus 0.10: Introducing the New State Serialization Algorithm</h1>


                <div class="post-full-byline">

                    <section class="post-full-byline-content">

                        <ul class="author-list">
                            <li class="author-list-item">

                                <div class="author-card">
                                    <img class="author-profile-image" src="//www.gravatar.com/avatar/c35f590e9178794d7f4c4f07192d3772?s&#x3D;250&amp;d&#x3D;mm&amp;r&#x3D;x" alt="Endel Dreyer" />
                                    <div class="author-info">
                                        <h2>Endel Dreyer</h2>
                                        <p>Read <a href="/author/endel/">more posts</a> by this author.</p>
                                    </div>
                                </div>

                                <a href="/author/endel/" class="author-avatar">
                                    <img class="author-profile-image" src="//www.gravatar.com/avatar/c35f590e9178794d7f4c4f07192d3772?s&#x3D;250&amp;d&#x3D;mm&amp;r&#x3D;x" alt="Endel Dreyer" />
                                </a>

                            </li>
                        </ul>

                        <section class="post-full-byline-meta">
                            <h4 class="author-name"><a href="/author/endel/">Endel Dreyer</a></h4>
                            <div class="byline-meta-content">
                                <time class="byline-meta-date" datetime="2019-03-28">28 Mar 2019</time>
                                <span class="byline-reading-time"><span class="bull">&bull;</span> 3 min read</span>
                            </div>
                        </section>

                    </section>


                </div>
            </header>

            <figure class="post-full-image">
                <img
                    srcset="/content/images/size/w300/2020/07/colyseus-0.10.x.png 300w,
                            /content/images/size/w600/2020/07/colyseus-0.10.x.png 600w,
                            /content/images/size/w1000/2020/07/colyseus-0.10.x.png 1000w,
                            /content/images/size/w2000/2020/07/colyseus-0.10.x.png 2000w"
                    sizes="(max-width: 800px) 400px,
                        (max-width: 1170px) 1170px,
                            2000px"
                    src="/content/images/size/w2000/2020/07/colyseus-0.10.x.png"
                    alt="Colyseus 0.10: Introducing the New State Serialization Algorithm"
                />
            </figure>

            <section class="post-full-content">
                <div class="post-content">
                    <p>I’m really excited to announce the release 0.10 of <a href="https://github.com/colyseus/colyseus" rel="noopener">Colyseus</a>. This version basically introduces a more performant state serialization algorithm and a different way of decoding the state in the client-side. It’s currently available for <a href="https://github.com/colyseus/colyseus.js" rel="noopener">JavaScript</a>, <a href="https://github.com/colyseus/colyseus-defold" rel="noopener">Defold Engine</a> and <a href="https://github.com/colyseus/colyseus-unity3d" rel="noopener">Unity3D</a>.</p><p>The new serializer (<a href="https://github.com/colyseus/schema" rel="noopener"><strong>@colyseus/schema</strong></a>) optimizes not only the throughput of your application but also memory and CPU consumption on both server-side and client-side. See the comparison between the number of bytes transferred using previous and new serializer of Colyseus.</p><figure class="kg-card kg-image-card"><img src="https://blog.endel.me/content/images/2020/07/bytes-comparison.png" class="kg-image" alt srcset="https://blog.endel.me/content/images/size/w600/2020/07/bytes-comparison.png 600w, https://blog.endel.me/content/images/2020/07/bytes-comparison.png 743w" sizes="(min-width: 720px) 720px"></figure><p>This is possible through strictly defining the data types of each property in the state. Only types with the “<strong>@type</strong>” annotation are going to be synchronized. There’s no need to use “<strong>@nosync</strong>” non-synchronizable properties anymore.</p><h2 id="what-was-the-problem-with-the-previous-serializer">What was the problem with the previous serializer?</h2><p>Besides being pretty easy to use, the previous serializer had some disadvantages both when encoding AND decoding large state objects.</p><ul><li>The server needed to take a snapshot of the state at every patch, even if no changes were made — to be able to check if the previous state snapshot differs from the current one. The patch was then broadcasted as a binary diff between them.</li><li>To apply the changes in the client-side, the patches were applied on top of the last snapshot sent by the server — which means the <strong>whole state needed</strong> to be deserialized again, creating a new copy of the state per patch and having a performance penalty if your state was slightly big.</li></ul><p>The good news is that the new serializer solves both of these problems.</p><h2 id="the-new-serializer-server-side">The New Serializer — Server-side</h2><p>In the state definition below, you’ll see a map of Player instances.</p><!--kg-card-begin: markdown--><pre><code class="language-typescript">import { Schema, MapSchema, type } from &quot;@colyseus/schema&quot;;

class Player extends Schema {
    @type(&quot;number&quot;)
    width: number;

    @type(&quot;number&quot;)
    height: number;
}

class MyState extends Schema {
    @type({ map: Player })
    players = new MapSchema&lt;Player&gt;();
}
</code></pre>
<!--kg-card-end: markdown--><p>Now, let’s instantiate the state in our room handler:</p><!--kg-card-begin: markdown--><pre><code class="language-typescript">import { Room } from &quot;colyseus&quot;;
import { MyState } from &quot;./MyState&quot;;
class MyRoom extends Room {
    onInit() {
        this.setState(new MyState());
    }
}
</code></pre>
<!--kg-card-end: markdown--><p>In the client-side, the state is available right after successfully joining the room. You can listen for additions, removals, and changes by registering callbacks directly into your decoded state variables.</p><h2 id="the-new-serializer-client-side-javascript-">The New Serializer — Client-side (JavaScript)</h2><p>The way you listen for a change in the client-side depends on the structure you’re interested in. Variable changes within a container are available through the “<strong>onChange</strong>” callback:</p><!--kg-card-begin: markdown--><pre><code class="language-typescript">var client = new Colyseus.Client(&quot;ws://localhost:2567&quot;);
var room = client.join(&quot;my_room&quot;);
room.onJoin.add(() =&gt; {
    room.state.onChange = (changes) =&gt; {
        changes.forEach(change =&gt; {
            console.log(change.field);
            console.log(change.value);
            console.log(change.previousValue);
        });
    };
})
</code></pre>
<!--kg-card-end: markdown--><p>Additions and removals of entries on Array’s and Map’s are available through “<strong>onAdd</strong>” and “<strong>onRemove</strong>” callbacks in the container variable.</p><!--kg-card-begin: markdown--><pre><code class="language-typescript">room.state.players.onAdd = (player, key) =&gt; {
    console.log(player, &quot;has been added at&quot;, key);
};
room.state.players.onRemove = (player, key) =&gt; {
    console.log(player, &quot;has been removed at&quot;, key);
};
</code></pre>
<!--kg-card-end: markdown--><p>For child entities inside Array’s and Map’s, you may detect changes of either the whole object or particular variables:</p><!--kg-card-begin: markdown--><pre><code class="language-typescript">// callback for a whole object change 
// not possible to know which properties have changed here
room.state.players.onChange = (player, key) =&gt; {
    console.log(player, &quot;has been changed at&quot;, key);
};

// callback for checking particular property changes
// this way you know exactly which properties have changed
room.state.players.onAdd = (player, key) =&gt; {
    player.onChange = function(changes) {
        changes.forEach(change =&gt; {
            console.log(change.field);
            console.log(change.value);
            console.log(change.previousValue);
        });
    }
};
</code></pre>
<!--kg-card-end: markdown--><p><a href="http://docs.colyseus.io/migrating/0.10/" rel="noopener">See the migration guide from version 0.9 to 0.10 here</a>.</p><h2 id="that-s-it-for-0-10">That’s it for 0.10</h2><p>I highly suggest you upgrade to version 0.10, even if you’re not going to use the new serializer yet. The previous serializer is still available and won’t be deprecated any time soon.</p><hr><h2 id="next-challenge-data-filters-work-in-progress-">Next challenge: data filters! (work in progress)</h2><p>I’ve started experimenting to allow filtering the data in the state for each client. The plan is to have different callbacks in the client-side whenever the data becomes available or unavailable.</p><p>The syntax for data filtering will most likely look like the example below — which demonstrates filtering entities by distance.</p><!--kg-card-begin: markdown--><pre><code class="language-typescript">import { Schema, type, filter } from &quot;@colyseus/schema&quot;;

export class State extends Schema {
  @filter(function(this: State, client: any, value: Entity) {
    const currentPlayer = this.entities[client.sessionId]

    var a = value.x - currentPlayer.x;
    var b = value.y - currentPlayer.y;

    return (Math.sqrt(a * a + b * b)) &lt;= 10;

  })
  @type({ map: Entity })
  entities = new MapSchema&lt;Entity&gt;();
}
</code></pre>
<!--kg-card-end: markdown--><hr><h2 id="feedback-is-always-very-welcome-">Feedback is always very welcome!</h2><p>Feel free to join the <a href="https://discord.gg/RY8rRS7" rel="noopener">Discord server</a> if you have any suggestions. If you just want to hang out with us, you’re welcome too!</p>
                </div>
            </section>



        </article>

    </div>

    <!-- Disqus comment -->
    <div id="disqus_thread"></div>
    <script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
    /*
    var disqus_config = function () {
    this.page.url = "http://" + window.location.host + window.location.pathname;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = "ghost-5f134023ea370c19f5372bf2"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://endel-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
    </script>

</main>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">

                <article class="post-card post tag-blogging ">

    <a class="post-card-image-link" href="/how-to-host-your-own-blog-with-ghost-github-pages/">
        <img class="post-card-image"
            srcset="/content/images/size/w300/2020/07/ghost-1.jpeg 300w,
                    /content/images/size/w600/2020/07/ghost-1.jpeg 600w,
                    /content/images/size/w1000/2020/07/ghost-1.jpeg 1000w,
                    /content/images/size/w2000/2020/07/ghost-1.jpeg 2000w"
            sizes="(max-width: 1000px) 400px, 700px"
            loading="lazy"
            src="/content/images/size/w600/2020/07/ghost-1.jpeg"
            alt="How to host your own blog with  Ghost + GitHub Pages"
        />
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/how-to-host-your-own-blog-with-ghost-github-pages/">

            <header class="post-card-header">
                    <div class="post-card-primary-tag">Blogging</div>
                <h2 class="post-card-title">How to host your own blog with  Ghost + GitHub Pages</h2>
            </header>

            <section class="post-card-excerpt">
                    <p>It has been some time since I've been thinking on moving the small amount of posts I have on Medium to somewhere else, without a particular company "owning" the content</p>
            </section>

        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
            
                    <div class="author-name-tooltip">
                        Endel Dreyer
                    </div>
            
                    <a href="/author/endel/" class="static-avatar">
                        <img class="author-profile-image" src="//www.gravatar.com/avatar/c35f590e9178794d7f4c4f07192d3772?s&#x3D;250&amp;d&#x3D;mm&amp;r&#x3D;x" alt="Endel Dreyer" />
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="/author/endel/">Endel Dreyer</a></span>
                <span class="post-card-byline-date"><time datetime="2020-07-18">18 Jul 2020</time> <span class="bull">&bull;</span> 3 min read</span>
            </div>
        </footer>

    </div>

</article>

        </div>
    </div>
</aside>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://blog.endel.me">Endel → Brain#dump()</a> &copy; 2020</section>
                <nav class="site-footer-nav">
                    <a href="https://blog.endel.me">Latest Posts</a>
                    
                    <a href="https://twitter.com/endel" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://github.com/endel" target="_blank" rel="noopener">GitHub</a>
                </nav>
            </div>
        </footer>

    </div>


    <script
        src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
        crossorigin="anonymous">
    </script>
    <script src="/assets/built/casper.js?v=0c1487f8cb"></script>

    <script>
        // Parse the URL parameter
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        // Give the parameter a variable name
        var action = getParameterByName('action');

        $(document).ready(function () {
            if (action == 'subscribe') {
                $('body').addClass("subscribe-success");
            }

            $('.subscribe-success-message .subscribe-close').click(function () {
                $('.subscribe-success-message').addClass('close');
            });

            // Reset form on opening subscrion overlay
            $('.subscribe-button').click(function() {
                $('.subscribe-overlay form').removeClass();
                $('.subscribe-email').val('');
            });
        });
    </script>

    <script>
    $(document).ready(function () {
        // FitVids - start
        var $postContent = $(".post-full-content");
        $postContent.fitVids();
        // FitVids - end

        // Replace nav with title on scroll - start
        Casper.stickyNavTitle({
            navSelector: '.site-nav-main',
            titleSelector: '.post-full-title',
            activeClass: 'nav-post-title-active'
        });
        // Replace nav with title on scroll - end

        // Hover on avatar
        var hoverTimeout;
        $('.author-list-item').hover(function () {
            var $this = $(this);

            clearTimeout(hoverTimeout);

            $('.author-card').removeClass('hovered');
            $(this).children('.author-card').addClass('hovered');

        }, function () {
            var $this = $(this);

            hoverTimeout = setTimeout(function () {
                $this.children('.author-card').removeClass('hovered');
            }, 800);
        });
    });
</script>


    <script>
    window.addEventListener('DOMContentLoaded', (event) => {      
        document.querySelectorAll('pre[class*=language-]').forEach(function(node) {
            node.classList.add('line-numbers');
		});
        Prism.highlightAll();
    });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/prism.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/plugins/toolbar/prism-toolbar.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/components/prism-typescript.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/components/prism-css.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/components/prism-bash.min.js"></script>

</body>
</html>
